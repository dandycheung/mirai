/*
 * Copyright 2019-2021 Mamoe Technologies and contributors.
 *
 *  此源代码的使用受 GNU AFFERO GENERAL PUBLIC LICENSE version 3 许可证的约束, 可以在以下链接找到该许可证.
 *  Use of this source code is governed by the GNU AGPLv3 license that can be found through the following link.
 *
 *  https://github.com/mamoe/mirai/blob/master/LICENSE
 */


package net.mamoe.mirai.internal

import kotlinx.io.core.discardExact
import kotlinx.io.core.readBytes
import net.mamoe.mirai.internal.network.protocol.packet.smartToString
import net.mamoe.mirai.internal.utils._miraiContentToString
import net.mamoe.mirai.internal.utils.crypto.TEA
import net.mamoe.mirai.internal.utils.soutv
import net.mamoe.mirai.utils.*


/*
[OUT]   Oicq Send A
OicqRequest(cmd=0x0810, subCmd=9, svcCmd='wtlogin.login')
00 18 00 16 00 01 00 00 06 00 00 00 00 10 00 00 00 00 76 E4 B8 DD 00 00 00 00 00 01 00 14 00 01 68 0E 84 37 76 E4 B8 DD 60 28 4F 8B 00 00 00 00 00 00 01 06 00 78 80 A8 2F D3 DC 8E 39 3F 62 37 B1 4B C9 43 08 3E 6E 0B 42 BD 10 D6 65 08 66 A8 1B FF 7E B3 74 1B A7 F6 A8 8B C9 40 52 2E A5 06 EE 17 EA DF 77 20 B2 F3 19 A3 60 2C 67 FD 10 C1 30 64 93 7D DA 8C 62 39 06 D6 53 83 13 6F CD E0 A1 D4 92 88 04 DA A9 C6 02 75 FE 5A E1 5A AC 2B C3 9D 29 D9 B0 E2 12 E0 C5 14 CE 16 4C A8 81 B1 1A C7 8D 9A C7 25 47 EA E7 CA D9 23 F6 6C 01 16 00 0E 00 0A F7 FF 7C 00 01 04 00 01 5F 5E 10 E2 01 00 00 16 00 01 00 00 00 0F 00 00 00 10 20 02 FD E2 00 00 00 00 02 14 10 E0 01 07 00 06 00 00 00 00 00 01 01 42 00 18 00 00 00 14 63 6F 6D 2E 74 65 6E 63 65 6E 74 2E 6D 6F 62 69 6C 65 71 71 01 44 01 B8 45 95 D1 54 E8 7E FA 3E FF B7 66 74 23 ED 31 2C 42 59 2F 8A 6C 31 6B AB 67 46 E7 A9 27 D5 53 7A 85 55 89 83 9D BC 20 51 85 EF 8A 76 6E EC C2 6A B1 55 5A D0 5F 3D 64 ED 17 93 6F 66 E1 FC 12 ED D0 13 31 A8 00 C9 52 A1 2F E1 7F BA 91 18 C8 32 A8 63 EE 84 7D 23 24 B2 84 E5 B1 B2 32 E3 CD 1C 23 3C D9 D6 DF BE 4C 12 29 F1 F7 A9 2A 4C D3 40 37 8C A2 B6 37 B1 B4 3B 2C 12 96 90 9B E9 89 D6 FE 5A EB 2F C8 60 13 D2 85 08 71 F9 02 93 3B 99 2C F1 58 77 FF 96 54 EB E5 66 99 8B F6 9E F5 E0 E7 38 14 24 04 05 73 AD F8 BF 28 F6 48 44 B1 5E A8 5C 3E BC 50 88 D2 5C 7B 56 CD 2C BB 98 66 BC 9F 78 A0 E3 02 FD 1C FE 4D 0B D1 AD 41 B5 F1 EC 2D 1C 40 07 2E C1 5F CE 3F 9B 91 E1 26 53 A6 6F 56 1D 4F 8D 01 25 87 99 1D 9E 86 A4 37 4C 70 77 79 16 89 17 86 7F 6E EE DB 77 C2 1B D7 59 AE E5 B4 A6 8A 81 1A 61 A7 33 6E 03 58 1A 7A 15 D8 52 53 16 DB 19 4F D2 B1 18 70 F0 B0 1D 80 C3 94 35 AF AE 59 F1 51 EE AF 69 ED 7F 1A 4D 9F B6 2F 11 92 31 32 88 60 13 04 A7 00 F4 C8 61 AC 65 4D 05 26 BD DF 0D 41 B7 9F CD F7 B1 61 6B 9E D7 AB 75 D7 58 53 38 34 22 E4 57 87 5D FB EE E8 ED A6 DF BE 4F 97 26 FA 9C 17 B5 16 EA 1B A0 C3 15 BF 3D 0B 12 81 5E E0 C8 EA F6 BE E8 F7 06 4D EC 50 3F 6E DA 75 90 85 DE A3 4A 84 39 3E CD E8 EC 42 89 4A C2 8C 79 8E 8B DD D8 86 2C A2 89 4F 06 F6 FC D7 A9 6F 54 36 6F BE C5 11 2C 98 13 A1 76 48 14 99 D8 C3 9B AC 42 53 D8 01 45 00 10 E2 9A BF 20 0D 00 CA F0 4D 28 CA 66 BF 31 6E AF 01 47 00 1D 00 00 00 10 00 05 38 2E 35 2E 35 00 10 A6 B7 45 BF 24 A2 C2 77 52 77 16 F6 F3 6E B6 8D 01 54 00 04 00 00 44 AF 01 41 00 1C 00 01 00 10 43 68 69 6E 61 20 4D 6F 62 69 6C 65 20 47 53 4D 00 02 00 04 77 69 66 69 00 08 00 08 00 00 00 00 08 04 00 00 05 11 00 D3 00 0E 01 00 0A 74 65 6E 70 61 79 2E 63 6F 6D 01 00 11 6F 70 65 6E 6D 6F 62 69 6C 65 2E 71 71 2E 63 6F 6D 01 00 0B 64 6F 63 73 2E 71 71 2E 63 6F 6D 01 00 0E 63 6F 6E 6E 65 63 74 2E 71 71 2E 63 6F 6D 01 00 0C 71 7A 6F 6E 65 2E 71 71 2E 63 6F 6D 01 00 0A 76 69 70 2E 71 71 2E 63 6F 6D 01 00 11 67 61 6D 65 63 65 6E 74 65 72 2E 71 71 2E 63 6F 6D 01 00 0A 71 75 6E 2E 71 71 2E 63 6F 6D 01 00 0B 67 61 6D 65 2E 71 71 2E 63 6F 6D 01 00 0C 71 71 77 65 62 2E 71 71 2E 63 6F 6D 01 00 09 74 69 2E 71 71 2E 63 6F 6D 01 00 0D 6F 66 66 69 63 65 2E 71 71 2E 63 6F 6D 01 00 0B 6D 61 69 6C 2E 71 71 2E 63 6F 6D 01 00 0A 6D 6D 61 2E 71 71 2E 63 6F 6D 01 87 00 10 30 86 EC F4 ED 94 5D D2 6F 88 8A 39 46 6C 22 7D 01 88 00 10 9D B6 A8 DF CB C1 79 06 EB 5D 95 FA 20 5A 9E 11 01 94 00 10 73 A1 26 09 B8 99 62 29 04 95 B9 9E 5C DA 22 8C 01 91 00 01 82 02 02 00 1B 00 10 36 85 4A A7 02 92 35 CE 9F B5 A2 D0 7A E4 88 F8 00 07 22 38 32 45 46 45 22 01 77 00 11 01 5F EC 50 93 00 0A 36 2E 30 2E 30 2E 32 34 36 33 05 16 00 04 00 00 00 00 05 21 00 06 00 00 00 00 00 00 05 25 00 08 00 01 05 36 00 02 01 00 05 44 00 AA 00 00 07 D9 00 00 00 00 00 2E 00 20 BF 93 73 5A 32 88 DF 8F E7 2B FA C2 33 7C 8D 70 95 FD 38 AB BA F0 90 F2 EF D7 EB 3C 22 26 01 6B 00 08 00 00 00 00 00 00 44 41 00 03 05 00 00 00 04 00 00 00 03 00 00 00 01 77 9D 76 B7 AF 75 24 24 35 33 37 25 36 38 21 00 14 63 6F 6D 2E 74 65 6E 63 65 6E 74 2E 6D 6F 62 69 6C 65 71 71 41 36 42 37 34 35 42 46 32 34 41 32 43 32 37 37 35 32 37 37 31 36 46 36 46 33 36 45 42 36 38 44 06 8C 81 44 00 00 00 00 00 00 03 00 00 01 00 10 AF 50 35 24 B5 7B 9D E1 2E AF 85 7D 45 39 9C E6

0x0018 = 00 01 00 00 06 00 00 00 00 10 00 00 00 00 76 E4 B8 DD 00 00 00 00
0x0001 = 00 01 68 0E 84 37 76 E4 B8 DD 60 28 4F 8B 00 00 00 00 00 00
0x0106 = 80 A8 2F D3 DC 8E 39 3F 62 37 B1 4B C9 43 08 3E 6E 0B 42 BD 10 D6 65 08 66 A8 1B FF 7E B3 74 1B A7 F6 A8 8B C9 40 52 2E A5 06 EE 17 EA DF 77 20 B2 F3 19 A3 60 2C 67 FD 10 C1 30 64 93 7D DA 8C 62 39 06 D6 53 83 13 6F CD E0 A1 D4 92 88 04 DA A9 C6 02 75 FE 5A E1 5A AC 2B C3 9D 29 D9 B0 E2 12 E0 C5 14 CE 16 4C A8 81 B1 1A C7 8D 9A C7 25 47 EA E7 CA D9 23 F6 6C
0x0116 = 00 0A F7 FF 7C 00 01 04 00 01 5F 5E 10 E2
0x0100 = 00 01 00 00 00 0F 00 00 00 10 20 02 FD E2 00 00 00 00 02 14 10 E0
0x0107 = 00 00 00 00 00 01
0x0142 = 00 00 00 14 63 6F 6D 2E 74 65 6E 63 65 6E 74 2E 6D 6F 62 69 6C 65 71 71
0x0144 = 45 95 D1 54 E8 7E FA 3E FF B7 66 74 23 ED 31 2C 42 59 2F 8A 6C 31 6B AB 67 46 E7 A9 27 D5 53 7A 85 55 89 83 9D BC 20 51 85 EF 8A 76 6E EC C2 6A B1 55 5A D0 5F 3D 64 ED 17 93 6F 66 E1 FC 12 ED D0 13 31 A8 00 C9 52 A1 2F E1 7F BA 91 18 C8 32 A8 63 EE 84 7D 23 24 B2 84 E5 B1 B2 32 E3 CD 1C 23 3C D9 D6 DF BE 4C 12 29 F1 F7 A9 2A 4C D3 40 37 8C A2 B6 37 B1 B4 3B 2C 12 96 90 9B E9 89 D6 FE 5A EB 2F C8 60 13 D2 85 08 71 F9 02 93 3B 99 2C F1 58 77 FF 96 54 EB E5 66 99 8B F6 9E F5 E0 E7 38 14 24 04 05 73 AD F8 BF 28 F6 48 44 B1 5E A8 5C 3E BC 50 88 D2 5C 7B 56 CD 2C BB 98 66 BC 9F 78 A0 E3 02 FD 1C FE 4D 0B D1 AD 41 B5 F1 EC 2D 1C 40 07 2E C1 5F CE 3F 9B 91 E1 26 53 A6 6F 56 1D 4F 8D 01 25 87 99 1D 9E 86 A4 37 4C 70 77 79 16 89 17 86 7F 6E EE DB 77 C2 1B D7 59 AE E5 B4 A6 8A 81 1A 61 A7 33 6E 03 58 1A 7A 15 D8 52 53 16 DB 19 4F D2 B1 18 70 F0 B0 1D 80 C3 94 35 AF AE 59 F1 51 EE AF 69 ED 7F 1A 4D 9F B6 2F 11 92 31 32 88 60 13 04 A7 00 F4 C8 61 AC 65 4D 05 26 BD DF 0D 41 B7 9F CD F7 B1 61 6B 9E D7 AB 75 D7 58 53 38 34 22 E4 57 87 5D FB EE E8 ED A6 DF BE 4F 97 26 FA 9C 17 B5 16 EA 1B A0 C3 15 BF 3D 0B 12 81 5E E0 C8 EA F6 BE E8 F7 06 4D EC 50 3F 6E DA 75 90 85 DE A3 4A 84 39 3E CD E8 EC 42 89 4A C2 8C 79 8E 8B DD D8 86 2C A2 89 4F 06 F6 FC D7 A9 6F 54 36 6F BE C5 11 2C 98 13 A1 76 48 14 99 D8 C3 9B AC 42 53 D8
0x0145 = E2 9A BF 20 0D 00 CA F0 4D 28 CA 66 BF 31 6E AF
0x0147 = 00 00 00 10 00 05 38 2E 35 2E 35 00 10 A6 B7 45 BF 24 A2 C2 77 52 77 16 F6 F3 6E B6 8D
0x0154 = 00 00 44 AF
0x0141 = 00 01 00 10 43 68 69 6E 61 20 4D 6F 62 69 6C 65 20 47 53 4D 00 02 00 04 77 69 66 69
0x0008 = 00 00 00 00 08 04 00 00
0x0511 = 00 0E 01 00 0A 74 65 6E 70 61 79 2E 63 6F 6D 01 00 11 6F 70 65 6E 6D 6F 62 69 6C 65 2E 71 71 2E 63 6F 6D 01 00 0B 64 6F 63 73 2E 71 71 2E 63 6F 6D 01 00 0E 63 6F 6E 6E 65 63 74 2E 71 71 2E 63 6F 6D 01 00 0C 71 7A 6F 6E 65 2E 71 71 2E 63 6F 6D 01 00 0A 76 69 70 2E 71 71 2E 63 6F 6D 01 00 11 67 61 6D 65 63 65 6E 74 65 72 2E 71 71 2E 63 6F 6D 01 00 0A 71 75 6E 2E 71 71 2E 63 6F 6D 01 00 0B 67 61 6D 65 2E 71 71 2E 63 6F 6D 01 00 0C 71 71 77 65 62 2E 71 71 2E 63 6F 6D 01 00 09 74 69 2E 71 71 2E 63 6F 6D 01 00 0D 6F 66 66 69 63 65 2E 71 71 2E 63 6F 6D 01 00 0B 6D 61 69 6C 2E 71 71 2E 63 6F 6D 01 00 0A 6D 6D 61 2E 71 71 2E 63 6F 6D
0x0187 = 30 86 EC F4 ED 94 5D D2 6F 88 8A 39 46 6C 22 7D
0x0188 = 9D B6 A8 DF CB C1 79 06 EB 5D 95 FA 20 5A 9E 11
0x0194 = 73 A1 26 09 B8 99 62 29 04 95 B9 9E 5C DA 22 8C
0x0191 = 82
0x0202 = 00 10 36 85 4A A7 02 92 35 CE 9F B5 A2 D0 7A E4 88 F8 00 07 22 38 32 45 46 45 22
0x0177 = 01 5F EC 50 93 00 0A 36 2E 30 2E 30 2E 32 34 36 33
0x0516 = 00 00 00 00
0x0521 = 00 00 00 00 00 00
0x0525 = 00 01 05 36 00 02 01 00
0x0544 = 00 00 07 D9 00 00 00 00 00 2E 00 20 BF 93 73 5A 32 88 DF 8F E7 2B FA C2 33 7C 8D 70 95 FD 38 AB BA F0 90 F2 EF D7 EB 3C 22 26 01 6B 00 08 00 00 00 00 00 00 44 41 00 03 05 00 00 00 04 00 00 00 03 00 00 00 01 77 9D 76 B7 AF 75 24 24 35 33 37 25 36 38 21 00 14 63 6F 6D 2E 74 65 6E 63 65 6E 74 2E 6D 6F 62 69 6C 65 71 71 41 36 42 37 34 35 42 46 32 34 41 32 43 32 37 37 35 32 37 37 31 36 46 36 46 33 36 45 42 36 38 44 06 8C 81 44 00 00 00 00 00 00 03 00 00 01 00 10 AF 50 35 24 B5 7B 9D E1 2E AF 85 7D 45 39 9C E6

[IN]    Oicq Recv A
OicqRequest(cmd=0x0810, subCmd=9, svcCmd='wtlogin.login')
00 09 CC 00 03 01 04 00 24 41 6F 79 37 67 4B 38 43 4A 59 52 30 7A 34 66 73 54 6B 4D 75 32 56 45 45 52 72 39 78 7A 37 76 39 68 67 3D 3D 04 02 00 08 41 5E 54 52 23 33 3B 2E 04 03 00 08 4D 41 5F 69 6E 4D 49 61

returnCode=204 (0xCC)
0x0104 = Aoy7gK8CJYR0z4fsTkMu2VEERr9xz7v9hg==
0x0402 = A^TR#3;.
0x0403 = MA_inMIa

[OUT]   Oicq Send A
OicqRequest(cmd=0x0810, subCmd=20, svcCmd='wtlogin.login')
00 08 00 08 00 00 00 00 08 04 00 00 01 04 00 24 41 6F 79 37 67 4B 38 43 4A 59 52 30 7A 34 66 73 54 6B 4D 75 32 56 45 45 52 72 39 78 7A 37 76 39 68 67 3D 3D 01 16 00 0E 00 0A F7 FF 7C 00 01 04 00 01 5F 5E 10 E2 04 01 00 10 96 ED 61 57 C6 14 D1 F5 0F 96 5D 70 F6 57 8F 73

0x0008 = 00 00 00 00 08 04 00 00
0x0104 = Aoy7gK8CJYR0z4fsTkMu2VEERr9xz7v9hg==
0x0116 = 00 0A F7 FF 7C 00 01 04 00 01 5F 5E 10 E2
0x0401 = 96 ED 61 57 C6 14 D1 F5 0F 96 5D 70 F6 57 8F 73

[IN]    Oicq Recv A
OicqRequest(cmd=0x0810, subCmd=20, svcCmd='wtlogin.login')
00 14 00 00 02 01 19 08 60 38 BE BA 97 2B 6F 59 DF 2F CC 84 16 FB BA 79 FD C7 B8 6F D3 82 30 A3 C4 15 F9 70 3A AE 85 40 3D 63 58 CF 01 DC 42 40 D1 D5 7E A6 8F 91 6B FC 78 66 63 5B C8 A5 1D 38 65 60 08 3B 0A CD 51 C0 D9 D6 9B 9B C2 74 04 1C AA F6 F2 4B 5A A8 BC A9 6B 6B 6D 6D 7A 3F 5C 5A 69 04 48 07 20 4E 0A 48 10 91 C0 18 CE 04 C1 BC D6 67 88 60 A1 08 42 95 6F 93 31 54 3B 31 4A 69 32 4F 2F 21 EC 9D 35 61 06 62 FC 25 8C C3 72 00 4F 6B 9F E2 71 5C 79 DB 8B C1 01 B4 51 A7 50 E7 85 72 89 39 ED 22 0E 9D 5E 87 7F 4C 5A 10 5E 52 A9 0E 77 A9 1C 2D C6 C9 BC EF 79 8E 36 2E 3B 5A 6B 5C 1F 1E A8 71 C5 4A 28 46 81 78 3D 69 95 58 FE 33 F2 FC DE 84 D1 06 F6 5D ED 56 EB C9 46 90 8A 9B 8A 0E 30 78 B9 DE 4F C7 E2 EC BD FF 7E 13 9C E3 10 48 71 24 6E 4A 43 0B 4E E9 2F 97 28 8C 46 04 D1 B2 09 9B 3C 29 D1 75 40 DC F5 DF 14 00 CA 10 4F 52 0E 99 E2 23 E2 05 7D B3 B6 4D FF F3 5A 9F C1 76 EE 3A CB 3C EE 92 76 12 EE 04 B3 C0 E6 BB C5 A2 3C C1 E0 4F 86 82 21 4B 92 5F B5 64 A8 BE 6B 60 91 B6 4E 4E 02 85 2D B2 B0 56 D0 7A 8A AA 63 57 43 80 38 0A D2 BB BE FA 37 8B 17 15 03 C0 6C 02 1D 4E 4B 8F 29 BC CA 73 28 90 FC 32 58 E2 6E 2C F1 00 4D 3C E9 F1 54 BE B9 0B 47 B7 79 B3 F2 A0 26 48 4B E6 9D 21 65 AC 78 08 3C ED 30 38 F5 ED E4 9B B1 6E C4 2E C7 F4 0A BA 50 A4 8A 2A 88 B1 43 BC B1 C2 FC 92 7B B9 E0 6E 44 D7 2F 6B AC 84 03 53 74 22 04 12 17 E7 D6 74 56 FE B0 DF 46 06 A2 CB 81 94 B0 BF F4 FA 34 F5 04 2C 10 3F 2B 58 37 F2 02 F8 C9 6D 6A C4 95 01 39 B0 F5 D9 1A 94 F6 00 90 90 F2 26 22 0F 2D F3 6A FA DA 81 1B 6B C2 C7 BD 0F AA F5 3E 94 4F 82 37 D3 24 EC 7D 88 61 89 B2 85 B2 0C 99 53 2E 50 44 FF 52 D4 67 BB 0B 30 DD 04 91 43 31 1E A8 70 A9 59 A9 E8 3F 82 89 CD C7 CA ED 80 78 20 00 6B 77 1A 67 B0 B6 9A 53 D3 32 22 E9 2D E4 C4 83 77 97 EA D2 75 FA 11 BE 71 70 DF 9B 7D 17 FF 68 A6 09 3E E1 E9 7A 9F ED 99 C6 B1 AE CD AB 92 B0 BB 95 DD 6C CA CA D4 B0 B3 41 85 76 FA 09 7E 6A C6 5F 2F D9 CE 9B 29 82 19 08 72 D3 30 C1 D0 FA 93 FD 3D 81 2B 69 31 9C 1F 1A 57 F3 7B AB 5E 69 83 B1 FA D1 82 E4 E4 FE 8A AB 60 EC 9F 3A BD 51 EE 57 08 1C 00 F8 D3 ED B7 76 84 DA E3 A6 A3 33 AC 13 55 12 23 AE 81 5C 2A 04 1C 06 06 8E 47 DB CA E8 0A 49 11 8D 69 73 0E A0 40 01 C1 A1 AB B9 20 C0 0E CD AF 45 03 20 2E 0B F1 B9 35 39 AE 0C 28 D4 96 6B 43 0F E8 FB D5 33 03 2E E3 32 C7 60 C3 93 1C 17 9F 66 48 4D E2 1A 32 A8 00 A4 2D 9F 74 C1 2C 49 85 08 B6 AB 33 3D D0 33 07 B2 70 88 89 A8 86 B9 89 22 19 D5 FA 94 0D 94 7C BC 0B 6B 11 E8 B4 2B 06 32 84 D7 91 A8 6B D3 0D 6E D1 AF 01 AF CC F7 11 24 2E 71 24 4C EB 17 9A C9 E4 62 46 2F 37 88 5A 2C C2 E6 41 D4 F7 01 98 AE 7F C9 6D F7 0F 6E 30 6F 5C 58 13 84 73 B2 F2 FD 91 D7 44 36 2C 92 A4 A6 70 EA CF FA F6 E1 2B AC B7 13 27 DF EC 2E 3B 41 F1 4B 57 B4 68 39 87 DF B5 9D 3A 11 60 02 29 CF B5 11 EE 25 5B 2A 10 2F 7F F9 6D C0 0E 53 16 71 48 72 B5 C0 B6 C4 CC 91 5E 05 FE D2 CC F0 72 04 0D 9D 84 4D FB 7D EE 46 46 86 EA E6 10 86 09 FF BE FE F0 F3 FA 2D 62 FA 97 7C 9A DA EC 89 1E 3C 16 90 87 EB C0 55 8C 7B 3E 3E F4 A1 68 5F 95 A4 9C 3A 72 17 48 8C 63 26 1C C5 CE 2E 28 0E 8F 4E E4 35 1C 8C AE 98 62 CE 4A F0 5E 03 BC F3 97 21 70 5F 3C 25 40 34 F7 AC DB F5 D5 6D 0C 73 37 A0 86 A0 1D 54 DA 61 C5 E0 E4 F9 F5 2E F7 00 47 F9 C5 E9 B1 5B F8 45 2A 78 AB DB D1 B6 CC 29 55 E1 BC A2 88 EC 92 66 BC 71 40 47 4B EC CF 01 8A 74 A6 9C 5F 4F C8 3D 40 FD B1 B2 C9 9C B4 F8 2F EF BD B2 C0 02 46 F8 D1 BF B4 C4 7E 84 F3 15 16 01 5B 1C A5 73 EE 4C 17 ED AF 37 D4 B8 7D EB DE D3 88 4E EC F4 EF 4C 02 FC 64 3E 97 8C 9F 91 6F 18 4C FD C9 BC BE 37 1D E0 4F 47 74 80 21 43 93 D3 9B 07 B8 6E 8B 18 C1 A7 DB 73 82 B8 57 6B D6 37 D0 B9 70 DD CC 36 FA 48 A7 0D B2 2A 0E 7C 1A DA 7D C9 B6 69 AF 60 F4 63 12 5B 87 40 73 7A 3E C5 7D 2D C1 EC 61 9D D1 39 C1 31 38 EE C1 B9 91 68 D9 B8 C4 8A B1 B7 0B 94 E0 CB 4E 22 F1 27 C7 43 F3 E3 71 C5 98 50 E2 6F 33 10 56 FA 57 E8 47 E4 D4 76 39 EC 31 D8 8D 9D CA 7B 3F B3 4E 21 64 1A E6 48 8D 09 A3 80 B7 3C 71 62 3C E2 2D F2 FE C4 1E D9 3F 62 BA 51 81 C2 F5 8E 64 63 50 5F EF 11 C1 21 83 C3 24 33 53 E9 67 73 6D 96 6D 5E B5 45 FD 75 86 6F 52 01 9A F8 EA 04 D1 5A CF 44 54 02 46 FC 2C ED 09 BF 10 C8 1C 45 55 BC 01 2F 1C CB 3C 2C E4 3E B8 CB 25 EC 79 04 92 A7 18 54 BE 4E 2B 89 35 AB 59 C3 78 80 38 12 E3 6A FA DB 33 79 92 95 39 8A 03 45 6F 5F 45 68 19 6F 81 60 77 38 63 BB 75 54 D9 01 A8 CC 80 9A 88 28 C3 5C 05 AB 4D 48 37 C0 7C 60 5B E8 94 70 C8 F9 FA 6E AC 03 92 88 52 C2 B5 CA 75 59 97 8C 5A AA 27 08 D4 69 01 2F 78 53 23 B6 0E 7C B3 23 C6 A1 6C FE A0 AD 14 AE DE 62 DB 6E 0C 52 FC 6B AA 88 18 99 E8 8D FD F9 3D C9 C9 7C F2 C3 64 AC BD 4C 35 C9 5A 4B 07 F2 73 21 87 88 2F B3 F1 B7 43 E6 B2 65 D5 55 8D 9F 02 B9 DC A8 BB 5A 28 3C 5E 3D C0 D3 50 77 0C C6 44 15 9A D0 5C 11 A7 AE 4D 56 7C 64 E4 28 DD 8B 99 FC 50 CB 17 81 35 8E 9C 42 94 5A F6 8C C5 BB F7 27 DB 7C 96 D4 E9 AC 53 A9 14 84 05 EC 12 F2 61 96 48 26 F0 C4 A4 2A E1 1A 15 C8 BA 17 27 CA 41 3D D8 E2 34 67 BB BB 87 36 65 CD 68 CE F6 6D CD 52 FC 79 1C C6 93 C7 8E 76 74 02 81 B7 9A 19 DF 3C 7C 01 53 8B 7B FC BB 26 28 CD 4F 6F 8A 3D 84 57 C4 7A DC A8 7A 34 27 DD 7B 9F 25 CF AB 78 05 AB 13 EA AE C3 11 65 5B 61 14 A1 67 3F D4 A7 37 04 24 F1 B4 D1 40 07 D7 2B 14 67 5B 77 08 38 E9 84 55 1C 42 4C C5 07 50 7B CE 61 68 04 A3 C1 24 C5 8C 6C 60 AA 68 05 22 A8 96 B2 93 3E 80 7F 14 77 D0 05 9C 1F 20 42 90 C8 89 89 58 00 0A 4F 3D D9 E8 60 55 17 40 CC 56 E9 84 F4 48 F1 98 AE 16 9A 4C AD 72 45 51 70 E6 20 41 2A 58 AC 88 5B F7 40 F9 A2 3E 81 6C 8E 4C 6C EE 5F 1E 57 A7 2B F6 B9 04 72 1D 9E D8 25 A1 BB 78 EB 0F 90 42 12 6A 9F 66 43 95 A9 90 40 71 0C B6 EC F4 B5 AE D4 B4 44 C9 B2 38 ED BC D4 36 EC F6 C2 61 08 38 B2 CE 48 5C 72 7C F0 11 AE 64 6F E1 DA 2E 43 6D 78 9A 9D 87 2F 66 BE 85 95 CB 70 44 37 39 61 96 BB B3 63 F5 73 ED F1 7A CE AA B8 F1 76 0D 7C 10 70 3A EC 31 5B CE F3 21 B0 90 D4 03 3C 4C 2C 59 CA 99 7E 28 05 E3 3A 9A 2B EB B7 3D 06 3E BA CD 87 8E EC 6E 03 E3 1F 46 72 08 EF CD 1B 87 06 36 73 9B C6 A7 5F 21 F5 F2 8A B5 6C 19 32 CB 90 FA D5 E6 2C 42 A2 48 AC FF B1 98 E2 36 A1 55 4B E1 55 16 4F C7 AC 8D F4 E5 BF 93 31 F2 9D 13 12 3B 35 ED 9A C0 F0 0F 0E AD 66 9B ED 8A F8 D7 B4 10 63 76 09 8A 00 EC 31 33 33 AF A0 84 41 14 9E EA FC 01 21 B1 7B 22 84 A3 8F C6 D3 DD A6 20 1C B5 78 87 11 82 B2 08 45 05 09 F8 ED 00 82 96 59 2F C8 C7 E4 8D 7A D2 73 23 D5 C5 AF 87 D5 5D E4 F7 11 33 87 AF F0 05 75 03 25 8A 2D D9 9E 1E C5 B6 1B 78 CD 96 6F C6 6E 7A 66 6B 86 C2 34 B4 ED 3B D7 98 A5 8F 3E 0C 4A 41 10 D5 D0 FE 0B 50 F4 42 53 73 A4 E8 39 DF 0C 2A 69 27 E9 C2 16 C0 E2 DA 14 C3 72 7D 5D D7 A3 19 6A CB FB 1B 2D 2A 50 1A 9E 2B 0B D7 D1 E8 96 20 61 86 1D 77 F8 DD 90 FC 5C C4 70 4C 8D 01 61 00 02 00 00

returnCode=0 (0x00)
0x0119 = 38 BE BA 97 2B 6F 59 DF 2F CC 84 16 FB BA 79 FD C7 B8 6F D3 82 30 A3 C4 15 F9 70 3A AE 85 40 3D 63 58 CF 01 DC 42 40 D1 D5 7E A6 8F 91 6B FC 78 66 63 5B C8 A5 1D 38 65 60 08 3B 0A CD 51 C0 D9 D6 9B 9B C2 74 04 1C AA F6 F2 4B 5A A8 BC A9 6B 6B 6D 6D 7A 3F 5C 5A 69 04 48 07 20 4E 0A 48 10 91 C0 18 CE 04 C1 BC D6 67 88 60 A1 08 42 95 6F 93 31 54 3B 31 4A 69 32 4F 2F 21 EC 9D 35 61 06 62 FC 25 8C C3 72 00 4F 6B 9F E2 71 5C 79 DB 8B C1 01 B4 51 A7 50 E7 85 72 89 39 ED 22 0E 9D 5E 87 7F 4C 5A 10 5E 52 A9 0E 77 A9 1C 2D C6 C9 BC EF 79 8E 36 2E 3B 5A 6B 5C 1F 1E A8 71 C5 4A 28 46 81 78 3D 69 95 58 FE 33 F2 FC DE 84 D1 06 F6 5D ED 56 EB C9 46 90 8A 9B 8A 0E 30 78 B9 DE 4F C7 E2 EC BD FF 7E 13 9C E3 10 48 71 24 6E 4A 43 0B 4E E9 2F 97 28 8C 46 04 D1 B2 09 9B 3C 29 D1 75 40 DC F5 DF 14 00 CA 10 4F 52 0E 99 E2 23 E2 05 7D B3 B6 4D FF F3 5A 9F C1 76 EE 3A CB 3C EE 92 76 12 EE 04 B3 C0 E6 BB C5 A2 3C C1 E0 4F 86 82 21 4B 92 5F B5 64 A8 BE 6B 60 91 B6 4E 4E 02 85 2D B2 B0 56 D0 7A 8A AA 63 57 43 80 38 0A D2 BB BE FA 37 8B 17 15 03 C0 6C 02 1D 4E 4B 8F 29 BC CA 73 28 90 FC 32 58 E2 6E 2C F1 00 4D 3C E9 F1 54 BE B9 0B 47 B7 79 B3 F2 A0 26 48 4B E6 9D 21 65 AC 78 08 3C ED 30 38 F5 ED E4 9B B1 6E C4 2E C7 F4 0A BA 50 A4 8A 2A 88 B1 43 BC B1 C2 FC 92 7B B9 E0 6E 44 D7 2F 6B AC 84 03 53 74 22 04 12 17 E7 D6 74 56 FE B0 DF 46 06 A2 CB 81 94 B0 BF F4 FA 34 F5 04 2C 10 3F 2B 58 37 F2 02 F8 C9 6D 6A C4 95 01 39 B0 F5 D9 1A 94 F6 00 90 90 F2 26 22 0F 2D F3 6A FA DA 81 1B 6B C2 C7 BD 0F AA F5 3E 94 4F 82 37 D3 24 EC 7D 88 61 89 B2 85 B2 0C 99 53 2E 50 44 FF 52 D4 67 BB 0B 30 DD 04 91 43 31 1E A8 70 A9 59 A9 E8 3F 82 89 CD C7 CA ED 80 78 20 00 6B 77 1A 67 B0 B6 9A 53 D3 32 22 E9 2D E4 C4 83 77 97 EA D2 75 FA 11 BE 71 70 DF 9B 7D 17 FF 68 A6 09 3E E1 E9 7A 9F ED 99 C6 B1 AE CD AB 92 B0 BB 95 DD 6C CA CA D4 B0 B3 41 85 76 FA 09 7E 6A C6 5F 2F D9 CE 9B 29 82 19 08 72 D3 30 C1 D0 FA 93 FD 3D 81 2B 69 31 9C 1F 1A 57 F3 7B AB 5E 69 83 B1 FA D1 82 E4 E4 FE 8A AB 60 EC 9F 3A BD 51 EE 57 08 1C 00 F8 D3 ED B7 76 84 DA E3 A6 A3 33 AC 13 55 12 23 AE 81 5C 2A 04 1C 06 06 8E 47 DB CA E8 0A 49 11 8D 69 73 0E A0 40 01 C1 A1 AB B9 20 C0 0E CD AF 45 03 20 2E 0B F1 B9 35 39 AE 0C 28 D4 96 6B 43 0F E8 FB D5 33 03 2E E3 32 C7 60 C3 93 1C 17 9F 66 48 4D E2 1A 32 A8 00 A4 2D 9F 74 C1 2C 49 85 08 B6 AB 33 3D D0 33 07 B2 70 88 89 A8 86 B9 89 22 19 D5 FA 94 0D 94 7C BC 0B 6B 11 E8 B4 2B 06 32 84 D7 91 A8 6B D3 0D 6E D1 AF 01 AF CC F7 11 24 2E 71 24 4C EB 17 9A C9 E4 62 46 2F 37 88 5A 2C C2 E6 41 D4 F7 01 98 AE 7F C9 6D F7 0F 6E 30 6F 5C 58 13 84 73 B2 F2 FD 91 D7 44 36 2C 92 A4 A6 70 EA CF FA F6 E1 2B AC B7 13 27 DF EC 2E 3B 41 F1 4B 57 B4 68 39 87 DF B5 9D 3A 11 60 02 29 CF B5 11 EE 25 5B 2A 10 2F 7F F9 6D C0 0E 53 16 71 48 72 B5 C0 B6 C4 CC 91 5E 05 FE D2 CC F0 72 04 0D 9D 84 4D FB 7D EE 46 46 86 EA E6 10 86 09 FF BE FE F0 F3 FA 2D 62 FA 97 7C 9A DA EC 89 1E 3C 16 90 87 EB C0 55 8C 7B 3E 3E F4 A1 68 5F 95 A4 9C 3A 72 17 48 8C 63 26 1C C5 CE 2E 28 0E 8F 4E E4 35 1C 8C AE 98 62 CE 4A F0 5E 03 BC F3 97 21 70 5F 3C 25 40 34 F7 AC DB F5 D5 6D 0C 73 37 A0 86 A0 1D 54 DA 61 C5 E0 E4 F9 F5 2E F7 00 47 F9 C5 E9 B1 5B F8 45 2A 78 AB DB D1 B6 CC 29 55 E1 BC A2 88 EC 92 66 BC 71 40 47 4B EC CF 01 8A 74 A6 9C 5F 4F C8 3D 40 FD B1 B2 C9 9C B4 F8 2F EF BD B2 C0 02 46 F8 D1 BF B4 C4 7E 84 F3 15 16 01 5B 1C A5 73 EE 4C 17 ED AF 37 D4 B8 7D EB DE D3 88 4E EC F4 EF 4C 02 FC 64 3E 97 8C 9F 91 6F 18 4C FD C9 BC BE 37 1D E0 4F 47 74 80 21 43 93 D3 9B 07 B8 6E 8B 18 C1 A7 DB 73 82 B8 57 6B D6 37 D0 B9 70 DD CC 36 FA 48 A7 0D B2 2A 0E 7C 1A DA 7D C9 B6 69 AF 60 F4 63 12 5B 87 40 73 7A 3E C5 7D 2D C1 EC 61 9D D1 39 C1 31 38 EE C1 B9 91 68 D9 B8 C4 8A B1 B7 0B 94 E0 CB 4E 22 F1 27 C7 43 F3 E3 71 C5 98 50 E2 6F 33 10 56 FA 57 E8 47 E4 D4 76 39 EC 31 D8 8D 9D CA 7B 3F B3 4E 21 64 1A E6 48 8D 09 A3 80 B7 3C 71 62 3C E2 2D F2 FE C4 1E D9 3F 62 BA 51 81 C2 F5 8E 64 63 50 5F EF 11 C1 21 83 C3 24 33 53 E9 67 73 6D 96 6D 5E B5 45 FD 75 86 6F 52 01 9A F8 EA 04 D1 5A CF 44 54 02 46 FC 2C ED 09 BF 10 C8 1C 45 55 BC 01 2F 1C CB 3C 2C E4 3E B8 CB 25 EC 79 04 92 A7 18 54 BE 4E 2B 89 35 AB 59 C3 78 80 38 12 E3 6A FA DB 33 79 92 95 39 8A 03 45 6F 5F 45 68 19 6F 81 60 77 38 63 BB 75 54 D9 01 A8 CC 80 9A 88 28 C3 5C 05 AB 4D 48 37 C0 7C 60 5B E8 94 70 C8 F9 FA 6E AC 03 92 88 52 C2 B5 CA 75 59 97 8C 5A AA 27 08 D4 69 01 2F 78 53 23 B6 0E 7C B3 23 C6 A1 6C FE A0 AD 14 AE DE 62 DB 6E 0C 52 FC 6B AA 88 18 99 E8 8D FD F9 3D C9 C9 7C F2 C3 64 AC BD 4C 35 C9 5A 4B 07 F2 73 21 87 88 2F B3 F1 B7 43 E6 B2 65 D5 55 8D 9F 02 B9 DC A8 BB 5A 28 3C 5E 3D C0 D3 50 77 0C C6 44 15 9A D0 5C 11 A7 AE 4D 56 7C 64 E4 28 DD 8B 99 FC 50 CB 17 81 35 8E 9C 42 94 5A F6 8C C5 BB F7 27 DB 7C 96 D4 E9 AC 53 A9 14 84 05 EC 12 F2 61 96 48 26 F0 C4 A4 2A E1 1A 15 C8 BA 17 27 CA 41 3D D8 E2 34 67 BB BB 87 36 65 CD 68 CE F6 6D CD 52 FC 79 1C C6 93 C7 8E 76 74 02 81 B7 9A 19 DF 3C 7C 01 53 8B 7B FC BB 26 28 CD 4F 6F 8A 3D 84 57 C4 7A DC A8 7A 34 27 DD 7B 9F 25 CF AB 78 05 AB 13 EA AE C3 11 65 5B 61 14 A1 67 3F D4 A7 37 04 24 F1 B4 D1 40 07 D7 2B 14 67 5B 77 08 38 E9 84 55 1C 42 4C C5 07 50 7B CE 61 68 04 A3 C1 24 C5 8C 6C 60 AA 68 05 22 A8 96 B2 93 3E 80 7F 14 77 D0 05 9C 1F 20 42 90 C8 89 89 58 00 0A 4F 3D D9 E8 60 55 17 40 CC 56 E9 84 F4 48 F1 98 AE 16 9A 4C AD 72 45 51 70 E6 20 41 2A 58 AC 88 5B F7 40 F9 A2 3E 81 6C 8E 4C 6C EE 5F 1E 57 A7 2B F6 B9 04 72 1D 9E D8 25 A1 BB 78 EB 0F 90 42 12 6A 9F 66 43 95 A9 90 40 71 0C B6 EC F4 B5 AE D4 B4 44 C9 B2 38 ED BC D4 36 EC F6 C2 61 08 38 B2 CE 48 5C 72 7C F0 11 AE 64 6F E1 DA 2E 43 6D 78 9A 9D 87 2F 66 BE 85 95 CB 70 44 37 39 61 96 BB B3 63 F5 73 ED F1 7A CE AA B8 F1 76 0D 7C 10 70 3A EC 31 5B CE F3 21 B0 90 D4 03 3C 4C 2C 59 CA 99 7E 28 05 E3 3A 9A 2B EB B7 3D 06 3E BA CD 87 8E EC 6E 03 E3 1F 46 72 08 EF CD 1B 87 06 36 73 9B C6 A7 5F 21 F5 F2 8A B5 6C 19 32 CB 90 FA D5 E6 2C 42 A2 48 AC FF B1 98 E2 36 A1 55 4B E1 55 16 4F C7 AC 8D F4 E5 BF 93 31 F2 9D 13 12 3B 35 ED 9A C0 F0 0F 0E AD 66 9B ED 8A F8 D7 B4 10 63 76 09 8A 00 EC 31 33 33 AF A0 84 41 14 9E EA FC 01 21 B1 7B 22 84 A3 8F C6 D3 DD A6 20 1C B5 78 87 11 82 B2 08 45 05 09 F8 ED 00 82 96 59 2F C8 C7 E4 8D 7A D2 73 23 D5 C5 AF 87 D5 5D E4 F7 11 33 87 AF F0 05 75 03 25 8A 2D D9 9E 1E C5 B6 1B 78 CD 96 6F C6 6E 7A 66 6B 86 C2 34 B4 ED 3B D7 98 A5 8F 3E 0C 4A 41 10 D5 D0 FE 0B 50 F4 42 53 73 A4 E8 39 DF 0C 2A 69 27 E9 C2 16 C0 E2 DA 14 C3 72 7D 5D D7 A3 19 6A CB FB 1B 2D 2A 50 1A 9E 2B 0B D7 D1 E8 96 20 61 86 1D 77 F8 DD 90 FC 5C C4 70 4C 8D
0x0161 = 00 00

 */

internal object DecodeIn {
    @JvmStatic
    fun main(args: Array<String>) {
        val login9 = """
    00 14 00 00 02 01 19 08 60 38 BE BA 97 2B 6F 59 DF 2F CC 84 16 FB BA 79 FD C7 B8 6F D3 82 30 A3 C4 15 F9 70 3A AE 85 40 3D 63 58 CF 01 DC 42 40 D1 D5 7E A6 8F 91 6B FC 78 66 63 5B C8 A5 1D 38 65 60 08 3B 0A CD 51 C0 D9 D6 9B 9B C2 74 04 1C AA F6 F2 4B 5A A8 BC A9 6B 6B 6D 6D 7A 3F 5C 5A 69 04 48 07 20 4E 0A 48 10 91 C0 18 CE 04 C1 BC D6 67 88 60 A1 08 42 95 6F 93 31 54 3B 31 4A 69 32 4F 2F 21 EC 9D 35 61 06 62 FC 25 8C C3 72 00 4F 6B 9F E2 71 5C 79 DB 8B C1 01 B4 51 A7 50 E7 85 72 89 39 ED 22 0E 9D 5E 87 7F 4C 5A 10 5E 52 A9 0E 77 A9 1C 2D C6 C9 BC EF 79 8E 36 2E 3B 5A 6B 5C 1F 1E A8 71 C5 4A 28 46 81 78 3D 69 95 58 FE 33 F2 FC DE 84 D1 06 F6 5D ED 56 EB C9 46 90 8A 9B 8A 0E 30 78 B9 DE 4F C7 E2 EC BD FF 7E 13 9C E3 10 48 71 24 6E 4A 43 0B 4E E9 2F 97 28 8C 46 04 D1 B2 09 9B 3C 29 D1 75 40 DC F5 DF 14 00 CA 10 4F 52 0E 99 E2 23 E2 05 7D B3 B6 4D FF F3 5A 9F C1 76 EE 3A CB 3C EE 92 76 12 EE 04 B3 C0 E6 BB C5 A2 3C C1 E0 4F 86 82 21 4B 92 5F B5 64 A8 BE 6B 60 91 B6 4E 4E 02 85 2D B2 B0 56 D0 7A 8A AA 63 57 43 80 38 0A D2 BB BE FA 37 8B 17 15 03 C0 6C 02 1D 4E 4B 8F 29 BC CA 73 28 90 FC 32 58 E2 6E 2C F1 00 4D 3C E9 F1 54 BE B9 0B 47 B7 79 B3 F2 A0 26 48 4B E6 9D 21 65 AC 78 08 3C ED 30 38 F5 ED E4 9B B1 6E C4 2E C7 F4 0A BA 50 A4 8A 2A 88 B1 43 BC B1 C2 FC 92 7B B9 E0 6E 44 D7 2F 6B AC 84 03 53 74 22 04 12 17 E7 D6 74 56 FE B0 DF 46 06 A2 CB 81 94 B0 BF F4 FA 34 F5 04 2C 10 3F 2B 58 37 F2 02 F8 C9 6D 6A C4 95 01 39 B0 F5 D9 1A 94 F6 00 90 90 F2 26 22 0F 2D F3 6A FA DA 81 1B 6B C2 C7 BD 0F AA F5 3E 94 4F 82 37 D3 24 EC 7D 88 61 89 B2 85 B2 0C 99 53 2E 50 44 FF 52 D4 67 BB 0B 30 DD 04 91 43 31 1E A8 70 A9 59 A9 E8 3F 82 89 CD C7 CA ED 80 78 20 00 6B 77 1A 67 B0 B6 9A 53 D3 32 22 E9 2D E4 C4 83 77 97 EA D2 75 FA 11 BE 71 70 DF 9B 7D 17 FF 68 A6 09 3E E1 E9 7A 9F ED 99 C6 B1 AE CD AB 92 B0 BB 95 DD 6C CA CA D4 B0 B3 41 85 76 FA 09 7E 6A C6 5F 2F D9 CE 9B 29 82 19 08 72 D3 30 C1 D0 FA 93 FD 3D 81 2B 69 31 9C 1F 1A 57 F3 7B AB 5E 69 83 B1 FA D1 82 E4 E4 FE 8A AB 60 EC 9F 3A BD 51 EE 57 08 1C 00 F8 D3 ED B7 76 84 DA E3 A6 A3 33 AC 13 55 12 23 AE 81 5C 2A 04 1C 06 06 8E 47 DB CA E8 0A 49 11 8D 69 73 0E A0 40 01 C1 A1 AB B9 20 C0 0E CD AF 45 03 20 2E 0B F1 B9 35 39 AE 0C 28 D4 96 6B 43 0F E8 FB D5 33 03 2E E3 32 C7 60 C3 93 1C 17 9F 66 48 4D E2 1A 32 A8 00 A4 2D 9F 74 C1 2C 49 85 08 B6 AB 33 3D D0 33 07 B2 70 88 89 A8 86 B9 89 22 19 D5 FA 94 0D 94 7C BC 0B 6B 11 E8 B4 2B 06 32 84 D7 91 A8 6B D3 0D 6E D1 AF 01 AF CC F7 11 24 2E 71 24 4C EB 17 9A C9 E4 62 46 2F 37 88 5A 2C C2 E6 41 D4 F7 01 98 AE 7F C9 6D F7 0F 6E 30 6F 5C 58 13 84 73 B2 F2 FD 91 D7 44 36 2C 92 A4 A6 70 EA CF FA F6 E1 2B AC B7 13 27 DF EC 2E 3B 41 F1 4B 57 B4 68 39 87 DF B5 9D 3A 11 60 02 29 CF B5 11 EE 25 5B 2A 10 2F 7F F9 6D C0 0E 53 16 71 48 72 B5 C0 B6 C4 CC 91 5E 05 FE D2 CC F0 72 04 0D 9D 84 4D FB 7D EE 46 46 86 EA E6 10 86 09 FF BE FE F0 F3 FA 2D 62 FA 97 7C 9A DA EC 89 1E 3C 16 90 87 EB C0 55 8C 7B 3E 3E F4 A1 68 5F 95 A4 9C 3A 72 17 48 8C 63 26 1C C5 CE 2E 28 0E 8F 4E E4 35 1C 8C AE 98 62 CE 4A F0 5E 03 BC F3 97 21 70 5F 3C 25 40 34 F7 AC DB F5 D5 6D 0C 73 37 A0 86 A0 1D 54 DA 61 C5 E0 E4 F9 F5 2E F7 00 47 F9 C5 E9 B1 5B F8 45 2A 78 AB DB D1 B6 CC 29 55 E1 BC A2 88 EC 92 66 BC 71 40 47 4B EC CF 01 8A 74 A6 9C 5F 4F C8 3D 40 FD B1 B2 C9 9C B4 F8 2F EF BD B2 C0 02 46 F8 D1 BF B4 C4 7E 84 F3 15 16 01 5B 1C A5 73 EE 4C 17 ED AF 37 D4 B8 7D EB DE D3 88 4E EC F4 EF 4C 02 FC 64 3E 97 8C 9F 91 6F 18 4C FD C9 BC BE 37 1D E0 4F 47 74 80 21 43 93 D3 9B 07 B8 6E 8B 18 C1 A7 DB 73 82 B8 57 6B D6 37 D0 B9 70 DD CC 36 FA 48 A7 0D B2 2A 0E 7C 1A DA 7D C9 B6 69 AF 60 F4 63 12 5B 87 40 73 7A 3E C5 7D 2D C1 EC 61 9D D1 39 C1 31 38 EE C1 B9 91 68 D9 B8 C4 8A B1 B7 0B 94 E0 CB 4E 22 F1 27 C7 43 F3 E3 71 C5 98 50 E2 6F 33 10 56 FA 57 E8 47 E4 D4 76 39 EC 31 D8 8D 9D CA 7B 3F B3 4E 21 64 1A E6 48 8D 09 A3 80 B7 3C 71 62 3C E2 2D F2 FE C4 1E D9 3F 62 BA 51 81 C2 F5 8E 64 63 50 5F EF 11 C1 21 83 C3 24 33 53 E9 67 73 6D 96 6D 5E B5 45 FD 75 86 6F 52 01 9A F8 EA 04 D1 5A CF 44 54 02 46 FC 2C ED 09 BF 10 C8 1C 45 55 BC 01 2F 1C CB 3C 2C E4 3E B8 CB 25 EC 79 04 92 A7 18 54 BE 4E 2B 89 35 AB 59 C3 78 80 38 12 E3 6A FA DB 33 79 92 95 39 8A 03 45 6F 5F 45 68 19 6F 81 60 77 38 63 BB 75 54 D9 01 A8 CC 80 9A 88 28 C3 5C 05 AB 4D 48 37 C0 7C 60 5B E8 94 70 C8 F9 FA 6E AC 03 92 88 52 C2 B5 CA 75 59 97 8C 5A AA 27 08 D4 69 01 2F 78 53 23 B6 0E 7C B3 23 C6 A1 6C FE A0 AD 14 AE DE 62 DB 6E 0C 52 FC 6B AA 88 18 99 E8 8D FD F9 3D C9 C9 7C F2 C3 64 AC BD 4C 35 C9 5A 4B 07 F2 73 21 87 88 2F B3 F1 B7 43 E6 B2 65 D5 55 8D 9F 02 B9 DC A8 BB 5A 28 3C 5E 3D C0 D3 50 77 0C C6 44 15 9A D0 5C 11 A7 AE 4D 56 7C 64 E4 28 DD 8B 99 FC 50 CB 17 81 35 8E 9C 42 94 5A F6 8C C5 BB F7 27 DB 7C 96 D4 E9 AC 53 A9 14 84 05 EC 12 F2 61 96 48 26 F0 C4 A4 2A E1 1A 15 C8 BA 17 27 CA 41 3D D8 E2 34 67 BB BB 87 36 65 CD 68 CE F6 6D CD 52 FC 79 1C C6 93 C7 8E 76 74 02 81 B7 9A 19 DF 3C 7C 01 53 8B 7B FC BB 26 28 CD 4F 6F 8A 3D 84 57 C4 7A DC A8 7A 34 27 DD 7B 9F 25 CF AB 78 05 AB 13 EA AE C3 11 65 5B 61 14 A1 67 3F D4 A7 37 04 24 F1 B4 D1 40 07 D7 2B 14 67 5B 77 08 38 E9 84 55 1C 42 4C C5 07 50 7B CE 61 68 04 A3 C1 24 C5 8C 6C 60 AA 68 05 22 A8 96 B2 93 3E 80 7F 14 77 D0 05 9C 1F 20 42 90 C8 89 89 58 00 0A 4F 3D D9 E8 60 55 17 40 CC 56 E9 84 F4 48 F1 98 AE 16 9A 4C AD 72 45 51 70 E6 20 41 2A 58 AC 88 5B F7 40 F9 A2 3E 81 6C 8E 4C 6C EE 5F 1E 57 A7 2B F6 B9 04 72 1D 9E D8 25 A1 BB 78 EB 0F 90 42 12 6A 9F 66 43 95 A9 90 40 71 0C B6 EC F4 B5 AE D4 B4 44 C9 B2 38 ED BC D4 36 EC F6 C2 61 08 38 B2 CE 48 5C 72 7C F0 11 AE 64 6F E1 DA 2E 43 6D 78 9A 9D 87 2F 66 BE 85 95 CB 70 44 37 39 61 96 BB B3 63 F5 73 ED F1 7A CE AA B8 F1 76 0D 7C 10 70 3A EC 31 5B CE F3 21 B0 90 D4 03 3C 4C 2C 59 CA 99 7E 28 05 E3 3A 9A 2B EB B7 3D 06 3E BA CD 87 8E EC 6E 03 E3 1F 46 72 08 EF CD 1B 87 06 36 73 9B C6 A7 5F 21 F5 F2 8A B5 6C 19 32 CB 90 FA D5 E6 2C 42 A2 48 AC FF B1 98 E2 36 A1 55 4B E1 55 16 4F C7 AC 8D F4 E5 BF 93 31 F2 9D 13 12 3B 35 ED 9A C0 F0 0F 0E AD 66 9B ED 8A F8 D7 B4 10 63 76 09 8A 00 EC 31 33 33 AF A0 84 41 14 9E EA FC 01 21 B1 7B 22 84 A3 8F C6 D3 DD A6 20 1C B5 78 87 11 82 B2 08 45 05 09 F8 ED 00 82 96 59 2F C8 C7 E4 8D 7A D2 73 23 D5 C5 AF 87 D5 5D E4 F7 11 33 87 AF F0 05 75 03 25 8A 2D D9 9E 1E C5 B6 1B 78 CD 96 6F C6 6E 7A 66 6B 86 C2 34 B4 ED 3B D7 98 A5 8F 3E 0C 4A 41 10 D5 D0 FE 0B 50 F4 42 53 73 A4 E8 39 DF 0C 2A 69 27 E9 C2 16 C0 E2 DA 14 C3 72 7D 5D D7 A3 19 6A CB FB 1B 2D 2A 50 1A 9E 2B 0B D7 D1 E8 96 20 61 86 1D 77 F8 DD 90 FC 5C C4 70 4C 8D 01 61 00 02 00 00
        """.trimIndent().hexToBytes()

        val map = login9.read {
            discardExact(5)
            _readTLVMap()
        }
        val t119 = map[0x119]!!

        val decrypted119 = TEA.decrypt(t119, tgtgtKey)
        println(map.smartToString())

        decrypted119.soutv("resp t119")
        decrypted119.read {
            discardExact(2)
            val tlvMap119 = _readTLVMap()
            tlvMap119.smartToString().soutv("RESP t119 inner TLV map")
        }
    }
}

val passwordMd5 = "xnjajsbsh:xunsA".md5()
val tgtgtKey = "23 52 CF C9 20 38 5C 3B B5 13 80 F6 BF EE 1F E7".hexToBytes()

internal object DecodeOut {
    @JvmStatic
    fun main(args: Array<String>) {
        val t106 = """
    80 A8 2F D3 DC 8E 39 3F 62 37 B1 4B C9 43 08 3E 6E 0B 42 BD 10 D6 65 08 66 A8 1B FF 7E B3 74 1B A7 F6 A8 8B C9 40 52 2E A5 06 EE 17 EA DF 77 20 B2 F3 19 A3 60 2C 67 FD 10 C1 30 64 93 7D DA 8C 62 39 06 D6 53 83 13 6F CD E0 A1 D4 92 88 04 DA A9 C6 02 75 FE 5A E1 5A AC 2B C3 9D 29 D9 B0 E2 12 E0 C5 14 CE 16 4C A8 81 B1 1A C7 8D 9A C7 25 47 EA E7 CA D9 23 F6 6C    
    """.trimIndent().hexToBytes()

        val key = (passwordMd5 + ByteArray(4) + 1994701021.toByteArray()).md5()

        val decrypted106 = TEA.decrypt(t106, key)
        println(decrypted106._miraiContentToString())

        val tgtgtKey = decrypted106.read {
            discardExact(51)
            readBytes(16)
        }
        tgtgtKey.soutv()
    }
}
/*
2021-02-14 16:40:19 D/soutv: RESP t119 inner TLV map =
count=29
0x0103 = A4 66 50 D2 4A 82 02 EF DD 9A 74 23 64 0C B0 03 01 E0 7B 1E 7D C3 35 75 79 BA C8 8D 89 F6 A6 AD 68 8E E1 57 F2 AB 89 3E 4D C6 8F 52 D3 F1 F2 5E
0x0106 = E5 C5 D4 3D EE AF 49 5A ED 1B 30 56 D3 DE 74 DE F6 FC F9 BE 16 DC 3B 37 10 94 0B 1D 04 FF 05 79 FC 14 ED 65 63 86 F3 BE C2 5E 88 22 1A A8 85 0C BC 6E 56 0F 4A 9A EC 20 DB FA 0D 66 6D D5 DD 68 9F 03 92 E4 5D 39 2E 36 D9 19 D1 A2 97 72 75 00 CD 29 5F ED 01 72 AD A5 4F 98 7B FD D3 0F DB 52 4F F3 28 E4 56 DE 87 08 7B 41 C2 20 E4 2C 2D D4 1E D3 08 C0 43 0D 77 46
0x0108 = F6 CE EF 4A EE A3 52 CB E0 96 C7 70 4D C0 4C C8
0x010A = DB 8F D4 91 57 AC EE 88 B6 CE E8 94 16 C0 14 5D AD 77 10 B6 F9 06 1F 20 9F 4E 34 9A 12 B0 2D 41 28 9E CB F0 C5 87 C2 C5 CE DE BD 6E 83 57 9F 2B 58 CD 53 64 89 EA 5C 2D CF 90 2F D6 AF DB FE 77 66 F4 97 27 DC 3F A6 38
0x010C = ukmD!cieHw@I:RV3
0x010D = '4+mgXR-KY!Dh7m7
0x010E = DDZ$5I]xpHdjX3Ja
0x0114 = 00 01 60 28 DB E5 00 58 CE 3D A1 CE 0C 33 F6 B6 21 F4 13 A6 5D BE 00 55 59 50 4A 70 AF 1A 0A D1 7A 64 5C D0 14 2D EA 35 5C 83 BF 13 34 F2 C3 CE 2E 4C 98 14 03 5F EE 90 8C 0F 4E 92 1E 55 B9 E5 80 11 D0 F2 AB 32 8C D4 31 56 2D 25 DC 61 70 C2 CB 38 3E E6 B1 F4 72 04 A6 38 13 86 C9 3A CF DD
0x0118 = 00 00 00 01 00
0x011A = 02 5B 07 02 08 43 69 6E 6E 61 6D 6F 6E
0x011D = 5F 5E 10 E2 6B 3D 61 2D 71 77 4D 79 25 55 7E 2A 5A 45 53 5E 00 60 00 01 60 28 DB E5 00 58 62 D4 C0 3F EB 47 D1 2B 38 63 A4 6D 2A 7D 6A 52 BE 5A 3B 02 C6 3B 6B 2B F5 7C AF 2D A6 CD D8 8A 5D D2 22 F9 C7 2E CC FF 82 DE ED A6 54 9B 16 E7 34 C3 F0 8C 0F 8C CF D4 D4 F4 7C 00 FE 2B 61 91 22 73 BF 7D B0 21 B1 75 3D BF 0B 10 0E 73 39 F0 8A 35 B0 F6 B6 67 95 1C
0x011F = 00 01 51 80 00 00 03 84 00 00
0x0120 = MZ6JcgxTFU
0x0130 = 00 00 60 28 DB E5 B4 2E 71 AB 00 00 00 00
0x0133 = 70 D2 63 35 EE E1 7E 5A 92 E7 EA A1 19 22 93 4C 3D D4 DB B7 51 22 56 D3 2F FB CB C5 6B 7E 87 BE 9A 11 02 DA DB E6 7A 23 3C 0B E9 96 B1 5D 14 C6
0x0134 = 2D 77 83 A0 9B 38 28 1F 28 76 70 87 37 7C D4 22
0x0138 = 00 00 00 01 01 0A 00 27 8D 00 00 00 00 00
0x0143 = FF C9 C7 8D 6C C1 1C DA AD 47 FB 00 AC D8 AF D2 51 43 F7 FF 29 68 BC 0B 72 D4 A5 35 23 9E EA D2 A6 F8 11 AB 3A B1 A7 55 EC 73 C6 75 14 96 77 B4 A1 74 1E A1 8D 29 CE FD 22 A6 F3 05 F6 65 0C 63
0x0163 = F[@V8,b:^.2.%9zw
0x016A = 95 AC D2 55 D2 C7 69 CE E6 C7 3E 07 7B B3 05 37 2C B1 48 CE CF 1E E0 C0 AA BD 9F E3 CA D7 6B F9 48 BE F7 88 A4 74 51 36 28 C3 70 D1 87 50 15 D7 81 4B 33 DA 50 02 C6 3C
0x016D = TsCYRZveN5MOQWJe1iB7MSrg7YPLztAGlCYVjGvidqU_
0x0203 = 8D C5 DC 7A C2 DC 9F CF 23 D5 94 DA C7 46 F1 03 6F 4C 6E E9 59 59 3B BF 59 FF 64 A2 60 9B E7 C6 75 71 F7 52 A8 E8 1B 2F 31 9D 25 5D E7 69 54 84 83 A6 82 57 AC 83 DA 61 43 D8 52 57 BC 9D 47 01 23 9D F1 A6 8E 28 65 F5 44 78 F5 0E FA 72 49 8F
0x0305 = q<>6-]f@Bf'F#:P:
0x0322 = CE 1E 2E DC 69 24 4F 9B FF 2F 52 D8 8F 69 DD 40
0x0512 = 00 0E 00 0A 74 65 6E 70 61 79 2E 63 6F 6D 00 2C 5A 32 4F 42 78 69 7A 64 63 62 6F 4F 46 50 2A 53 61 74 58 64 43 47 74 77 7A 75 6B 47 59 4C 5A 53 2A 49 41 5A 64 6F 67 76 49 53 55 5F 00 00 00 11 6F 70 65 6E 6D 6F 62 69 6C 65 2E 71 71 2E 63 6F 6D 00 2C 34 37 4D 56 47 49 51 57 4E 76 6D 4D 71 6F 39 76 46 34 73 68 6F 47 42 48 7A 38 75 47 64 6C 74 33 39 53 52 54 79 41 61 34 61 31 77 5F 00 00 00 0B 64 6F 63 73 2E 71 71 2E 63 6F 6D 00 2C 49 6F 56 37 64 57 32 46 6E 32 34 43 73 43 73 4F 2A 4F 63 42 44 59 37 7A 4B 39 4F 36 61 5A 47 65 35 50 71 52 38 73 55 64 5A 4D 55 5F 00 00 00 0E 63 6F 6E 6E 65 63 74 2E 71 71 2E 63 6F 6D 00 2C 64 34 59 56 54 78 57 2D 5A 71 37 4D 30 55 30 76 4C 68 68 43 30 33 2D 57 6D 76 44 54 33 6F 78 47 5A 4E 5A 52 70 2D 4A 34 57 61 67 5F 00 00 00 0C 71 7A 6F 6E 65 2E 71 71 2E 63 6F 6D 00 2C 78 6A 64 43 38 76 6D 39 69 78 6F 67 2D 68 58 59 75 71 42 71 6C 59 6C 4D 76 6D 4D 6A 4E 41 53 61 6D 66 4D 49 37 44 4C 34 4A 53 45 5F 00 00 00 0A 76 69 70 2E 71 71 2E 63 6F 6D 00 2C 36 4E 55 7A 7A 39 4B 4A 4F 57 66 4B 4F 61 32 6B 4D 56 69 2D 34 33 57 5A 4D 58 6D 78 64 4F 63 4F 32 75 52 67 4E 71 6F 6D 35 56 45 5F 00 00 00 11 67 61 6D 65 63 65 6E 74 65 72 2E 71 71 2E 63 6F 6D 00 2C 39 44 67 45 6D 51 7A 50 2A 63 56 52 36 53 69 6E 45 78 36 33 36 57 31 64 4F 57 53 79 78 30 36 4F 51 61 51 79 37 45 5A 57 54 6D 67 5F 00 00 00 0A 71 75 6E 2E 71 71 2E 63 6F 6D 00 2C 30 33 71 2D 47 77 4B 4E 52 5A 70 52 44 48 39 4F 72 33 76 6C 32 79 39 75 49 70 61 34 74 4C 4C 52 6A 37 38 70 43 77 31 46 5A 57 51 5F 00 00 00 0B 67 61 6D 65 2E 71 71 2E 63 6F 6D 00 2C 55 4B 6B 38 47 30 64 41 49 30 6F 4B 67 6E 63 6A 4D 6F 30 47 54 49 36 36 69 77 48 46 6C 57 30 51 4E 30 42 39 4A 52 6E 33 6F 6B 73 5F 00 00 00 0C 71 71 77 65 62 2E 71 71 2E 63 6F 6D 00 2C 4B 58 2A 5A 43 5A 41 61 67 4E 6E 74 35 65 49 6B 6D 4F 71 6A 65 30 72 49 5A 77 6D 31 4F 4B 76 70 66 77 33 79 53 51 30 34 48 79 63 5F 00 00 00 09 74 69 2E 71 71 2E 63 6F 6D 00 2C 4A 2D 49 6D 48 33 36 55 30 78 47 75 5A 4F 37 2D 65 62 64 74 69 72 38 76 4D 51 71 57 61 32 65 53 70 4A 79 47 78 57 42 68 74 50 4D 5F 00 00 00 0D 6F 66 66 69 63 65 2E 71 71 2E 63 6F 6D 00 2C 34 4B 74 47 76 42 4F 71 6D 6D 4D 7A 7A 7A 67 4D 36 42 37 43 4D 56 6A 58 39 52 6B 53 74 76 4F 36 45 2A 4B 53 4C 4B 33 4D 5A 6F 67 5F 00 00 00 0B 6D 61 69 6C 2E 71 71 2E 63 6F 6D 00 2C 74 77 31 33 56 7A 45 7A 44 66 32 6A 5A 50 46 56 57 6D 47 67 67 58 5A 73 61 74 42 45 46 63 79 46 6B 38 35 49 6B 7A 35 6F 64 2D 49 5F 00 00 00 0A 6D 6D 61 2E 71 71 2E 63 6F 6D 00 2C 38 71 6A 2D 4C 37 75 45 6E 50 4B 54 49 66 66 78 2A 64 68 6B 68 7A 78 31 6D 34 79 76 63 58 67 57 37 32 5A 55 6A 58 61 42 6E 41 67 5F 00 00
0x0522 = 00 00 00 00 76 E4 B8 DD AB 71 2E B4 60 28 DB E5 20 02 FD E2
0x0528 = {"QIM_invitation_bit":"1"}
0x0537 = 01 01 00 00 00 00 76 E4 B8 DD 04 AB 71 2E B4 60 28 DB E5 20 02 FD E2
0x0550 = 58 00 60 03 6A 14 00 00 00 00 00 00 00 00 01 02 00 00 00 00 00 00 28 90 00 00 82 01 06 08 83 9E 91 F7 04



encryptA1:
E5 C5 D4 3D EE AF 49 5A ED 1B 30 56 D3 DE 74 DE F6 FC F9 BE 16 DC 3B 37 10 94 0B 1D 04 FF 05 79 FC 14 ED 65 63 86 F3 BE C2 5E 88 22 1A A8 85 0C BC 6E 56 0F 4A 9A EC 20 DB FA 0D 66 6D D5 DD 68 9F 03 92 E4 5D 39 2E 36 D9 19 D1 A2 97 72 75 00 CD 29 5F ED 01 72 AD A5 4F 98 7B FD D3 0F DB 52 4F F3 28 E4 56 DE 87 08 7B 41 C2 20 E4 2C 2D D4 1E D3 08 C0 43 0D 77 46

tgt:
DB 8F D4 91 57 AC EE 88 B6 CE E8 94 16 C0 14 5D AD 77 10 B6 F9 06 1F 20 9F 4E 34 9A 12 B0 2D 41 28 9E CB F0 C5 87 C2 C5 CE DE BD 6E 83 57 9F 2B 58 CD 53 64 89 EA 5C 2D CF 90 2F D6 AF DB FE 77 66 F4 97 27 DC 3F A6 38

tgtKey:
'4+mgXR-KY!Dh7m7

d2:
FF C9 C7 8D 6C C1 1C DA AD 47 FB 00 AC D8 AF D2 51 43 F7 FF 29 68 BC 0B 72 D4 A5 35 23 9E EA D2 A6 F8 11 AB 3A B1 A7 55 EC 73 C6 75 14 96 77 B4 A1 74 1E A1 8D 29 CE FD 22 A6 F3 05 F6 65 0C 63

d2Key:
q<>6-]f@Bf'F#:P:

da2:
8D C5 DC 7A C2 DC 9F CF 23 D5 94 DA C7 46 F1 03 6F 4C 6E E9 59 59 3B BF 59 FF 64 A2 60 9B E7 C6 75 71 F7 52 A8 E8 1B 2F 31 9D 25 5D E7 69 54 84 83 A6 82 57 AC 83 DA 61 43 D8 52 57 BC 9D 47 01 23 9D F1 A6 8E 28 65 F5 44 78 F5 0E FA 72 49 8F

wtSessionTicket:
70 D2 63 35 EE E1 7E 5A 92 E7 EA A1 19 22 93 4C 3D D4 DB B7 51 22 56 D3 2F FB CB C5 6B 7E 87 BE 9A 11 02 DA DB E6 7A 23 3C 0B E9 96 B1 5D 14 C6

wtSessionTicketKey:
2D 77 83 A0 9B 38 28 1F 28 76 70 87 37 7C D4 22

 */